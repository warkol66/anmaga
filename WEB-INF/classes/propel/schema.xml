 <database defaultIdMethod="native" name="anmaga" >

 <table name="users_user" phpName='User' description="Users">
  <column name="id" required="true" primaryKey="true" type="INTEGER" description="User Id" autoIncrement="true"/>
  <column name="username" required="true"  type="VARCHAR" size="255" description="username"/>
  <column name="password" required="true"  type="VARCHAR" size="255" description="password"/>
  <column name="active" required="true"  type="BOOLEAN"  description="Is user active?"/>
  <column name="created" required="true"  type="TIMESTAMP"  description="Creation date for"/>
  <column name="updated" required="true"  type="TIMESTAMP"  description="Last update date"/>
  <column name="levelId" type="INTEGER" description="User Level" />
	<unique>
		<unique-column name="username" />
	</unique>
  <foreign-key foreignTable="users_userInfo" >
    <reference local="id" foreign="userId" />
  </foreign-key>
  <foreign-key foreignTable="users_level" >
    <reference local="levelId" foreign="id" />
  </foreign-key>
 </table>

 <table name="users_userInfo" phpName='UserInfo' description="Information about users">
  <column name="userId" required="true" primaryKey="true" type="INTEGER" description="User Id" />
  <column name="name" type="VARCHAR" size="255" description="name"/>
  <column name="surname" type="VARCHAR" size="255" description="surname"/>
	<foreign-key foreignTable="users_user" >
      <reference local="userId" foreign="id" />
    </foreign-key>
 </table>

  <table name="users_userGroup" phpName='UserGroup' description="Users / Groups">
  <column name="userId" required="true" primaryKey='true' type="INTEGER"  description="Group ID"/>
  <column name="groupId" required="true" primaryKey='true' type="INTEGER"  description="Group ID"/>
  <foreign-key foreignTable="users_user">
     <reference local="userId" foreign="id"/>
  </foreign-key>
  <foreign-key foreignTable="users_group" onDelete="cascade">
     <reference local="groupId" foreign="id"/>
  </foreign-key>
 </table>

 <table name="users_group" phpName='Group' description="Groups">
  <column name="id" required="true"  primaryKey='true' type="INTEGER"  description="Group ID" autoIncrement="true"/>
  <column name="name" required="true"  type="VARCHAR" size="255"  description="Group Name"/>
  <column name="created" required="true"  type="TIMESTAMP"  description="Creation date for"/>
  <column name="updated" required="true"  type="TIMESTAMP"  description="Last update date"/>
  <column name="bitLevel"   type="INTEGER"  description="Nivel"/>
	<unique>
		<unique-column name="name" />
	</unique>
 </table>

 <table name="users_level" phpName='Level' description="Levels">
  <column name="id" required="true"  primaryKey='true' type="INTEGER"  description="Level ID" autoIncrement="true"/>
  <column name="name" required="true"  type="VARCHAR" size="255"  description="Level Name"/>
  <column name="bitLevel" type="INTEGER"  description="Bit del nivel"/>
	<unique>
		<unique-column name="name" />
	</unique>
 </table>

   <table name="security_action" phpName="SecurityAction"  description="Actions del sistema">
    <column name="action" type="VARCHAR" size="100" description="Action pagina" primaryKey='true' />
		<column name="module" type="VARCHAR" size="100" description="Modulo" />
		<column name="section" type="VARCHAR" size="100" description="Seccion"/>
    <column name="access" type="INTEGER" description="El acceso a ese action" />
    <column name="accessUsersByAffiliate" type="INTEGER" description="El acceso a ese action para los usuarios por afiliados" />
		<column name="active" type="INTEGER" description="Si el action esta activo o no" />
    <column name="pair" type="VARCHAR" size="100" description="Par del Action" />
  </table>


  <table name="affiliate" phpName="Affiliate"  description="Afiliados">
	 <column name="id" required="true" primaryKey="true" type="INTEGER" description="Id afiliado" autoIncrement="true"/>
	 <column name="name" required="true"  type="VARCHAR" size="255" description="nombre afiliado"/>
    <foreign-key foreignTable="affiliateInfo" >
    <reference local="id" foreign="affiliateId" />
  </foreign-key>
  </table>

  <table name="affiliateInfo" phpName="AffiliateInfo"  description="Informacion del afiliado">
	 <column name="affiliateId" primaryKey="true" required="true" type="INTEGER" description="Id afiliado"/>
	 <column name="affiliateInternalNumber" required="true" type="INTEGER" description="Id interno"/>
	 <column name="address" type="VARCHAR" size="255" description="Direccion afiliado"/>
	 <column name="phone" type="VARCHAR" size="50" description="Telefono afiliado"/>
	 <column name="email" type="VARCHAR" size="50" description="Email afiliado"/>
	 <column name="contact" type="VARCHAR" size="50" description="Nombre de persona de contacto"/>
	<foreign-key foreignTable="affiliate" >
		<reference local="affiliateId" foreign="id" />
	</foreign-key>

  </table>




 <table name="usersByAffiliate_user" phpName='UserByAffiliate' description="Usuarios de afiliado">
  <column name="id" required="true" primaryKey="true" type="INTEGER" description="User Id" autoIncrement="true"/>
 <column name="affiliateId" required="true" type="INTEGER" description="Id afiliado"/>
  <column name="username" required="true"  type="VARCHAR" size="255" description="username"/>
  <column name="password" required="true"  type="VARCHAR" size="255" description="password"/>
  <column name="active" required="true"  type="BOOLEAN"  description="Is user active?"/>
  <column name="created" required="true"  type="TIMESTAMP"  description="Creation date for"/>
  <column name="updated" required="true"  type="TIMESTAMP"  description="Last update date"/>
  <column name="levelId" type="INTEGER" description="User Level" />
	<unique>
		<unique-column name="username" />
	</unique>
  <foreign-key foreignTable="usersByAffiliate_userInfo" >
    <reference local="id" foreign="userId" />
  </foreign-key>
  <foreign-key foreignTable="usersByAffiliate_level" >
    <reference local="levelId" foreign="id" />
  </foreign-key>
  	<foreign-key foreignTable="affiliate" >
		<reference local="affiliateId" foreign="id" />
	</foreign-key>
 </table>
 
 <table name="usersByAffiliate_userInfo" phpName='UsersByAffiliateUserInfo' description="Information about users by affiliates">
  <column name="userId" required="true" primaryKey="true" type="INTEGER" description="User Id" />
  <column name="name" type="VARCHAR" size="255" description="name"/>
  <column name="surname" type="VARCHAR" size="255" description="surname"/>
	<foreign-key foreignTable="usersByAffiliate_user" >
      <reference local="userId" foreign="id" />
    </foreign-key>
 </table>
 
 <table name="usersByAffiliate_level" phpName='UsersByAffiliateLevel' description="Levels">
  <column name="id" required="true"  primaryKey='true' type="INTEGER"  description="Level ID" autoIncrement="true"/>
  <column name="name" required="true"  type="VARCHAR" size="255"  description="Level Name"/>
  <column name="bitLevel" type="INTEGER"  description="Bit del nivel"/>
	<unique>
		<unique-column name="name" />
	</unique>
 </table>
 
  <table name="usersByAffiliate_userGroup" phpName='UsersByAffiliateUserGroup' description="Users / Groups">
  <column name="userId" required="true" primaryKey='true' type="INTEGER"  description="Group ID"/>
  <column name="groupId" required="true" primaryKey='true' type="INTEGER"  description="Group ID"/>
  <foreign-key foreignTable="usersByAffiliate_user">
     <reference local="userId" foreign="id"/>
  </foreign-key>
  <foreign-key foreignTable="usersByAffiliate_group" onDelete="cascade">
     <reference local="groupId" foreign="id"/>
  </foreign-key>
 </table>

 <table name="usersByAffiliate_group" phpName='UsersByAffiliateGroup' description="Groups">
  <column name="id" required="true"  primaryKey='true' type="INTEGER"  description="Group ID" autoIncrement="true"/>
  <column name="name" required="true"  type="VARCHAR" size="255"  description="Group Name"/>
  <column name="created" required="true"  type="TIMESTAMP"  description="Creation date for"/>
  <column name="updated" required="true"  type="TIMESTAMP"  description="Last update date"/>
  <column name="bitLevel"   type="INTEGER"  description="Nivel"/>
	<unique>
		<unique-column name="name" />
	</unique>
 </table>
 
  <table phpName="Category" name="category" description="Categorias" >
    <column autoIncrement="true" type="INTEGER" name="id" required="true" description="" primaryKey='true' />
    <column size="255" type="VARCHAR" name="name" required="true" description="Category name" />
    <column type="BOOLEAN" name="active" required="true" description="Is category active?" />
  </table>
  
 <table name="users_groupCategory" phpName='GroupCategory' description="Groups / Categories">
  <column name="groupId" required="true" primaryKey='true' type="INTEGER"  description="Group ID"/>
  <column name="categoryId" required="true" primaryKey='true' type="INTEGER"  description="Category ID"/>
  <foreign-key foreignTable="users_group" onDelete="cascade">
     <reference local="groupId" foreign="id"/>
  </foreign-key>
  <foreign-key foreignTable="category">
     <reference local="categoryId" foreign="id"/>
  </foreign-key>
 </table>
 
 <table name="usersByAffiliate_groupCategory" phpName='UsersByAffiliateGroupCategory' description="Groups / Categories">
  <column name="groupId" required="true" primaryKey='true' type="INTEGER"  description="Group ID"/>
  <column name="categoryId" required="true" primaryKey='true' type="INTEGER"  description="Category ID"/>
  <foreign-key foreignTable="usersByAffiliate_group" onDelete="cascade">
     <reference local="groupId" foreign="id"/>
  </foreign-key>
  <foreign-key foreignTable="category">
     <reference local="categoryId" foreign="id"/>
  </foreign-key>
 </table>


<table name="modules_module" phpName='Module' description=" Registro de modulos">
  <column name="name" required="true" primaryKey='true' size="255" type="VARCHAR"  description="nombre del modulo"/>
   <column size="255" type="VARCHAR" name="label" description="Etiqueta" />
    <column size="255" type="VARCHAR" name="description" description="Descripcion del modulo" />
  <column name="active" required="true" type="BOOLEAN"  default="0" description="Estado del modulo"/>
  <column name="alwaysActive" required="true" type="BOOLEAN"  default="0" description="Modulo siempre activo"/>
<foreign-key foreignTable="modules_dependency" onDelete="cascade">
     <reference local="name" foreign="module"/>
  </foreign-key> 
 
 </table>

 <table name="modules_dependency" phpName='ModuleDependency' description="Dependencia de modulos ">
   <column size="255" type="VARCHAR" primaryKey='true' name="module" description="Modulo" />
    <column size="255" type="VARCHAR" primaryKey='true' name="dependence" description="Dependiente" />
 </table>


<!--<table phpName="ActionLog" name="log_actionLog" description="logs del sistema">
	<column name="id" type="INTEGER"  required="true" description="Id log" primaryKey="true" autoIncrement="true"  />
	<column name="userId" type="INTEGER"  required="true" description="Id del usuario" />
	<column name="affiliateId" type="INTEGER"  required="true" description="Id del afiliado" />
	<column name="datetime" type="TIMESTAMP"  required="true" description="Fecha en que se logueo el dato" />
	<column name="action" type="VARCHAR" size="100"  required="true" description="action en que se logueo el dato" />
	<column name="message" type="VARCHAR" size="100"  required="true" description="mensaje del log"/>
	<foreign-key foreignTable="users_user" >
		<reference local="userId" foreign="id" />
	</foreign-key>
	<foreign-key foreignTable="SecurityAction" >
		<reference local="action" foreign="action" />
	</foreign-key>
</table>-->

  <table phpName="Node" name="node" description="Nodo del Arbol" >
    <column name="id" autoIncrement="true" type="INTEGER" required="true" description="Id del nodo" primaryKey='true' />
    <column name="name" size="255" type="VARCHAR" required="true" description="Nombre del nodo" />
    <column name="kind" size="255" type="VARCHAR" required="true" description="Tipo de nodo" />
    <column name="objectId" type="INTEGER" description="Id del objeto relacionado al nodo" />
    <column name="parentId" type="INTEGER" description="Id del nodo padre" />
    <column name="position" type="INTEGER" description="Orden entre los hermanos del nodo" />
		<foreign-key foreignTable="node" >
			<reference local="parentId" foreign="id" />
		</foreign-key>
  </table>
  
  <table phpName="Product" name="product" description="Producto">
    <column name="id" autoIncrement="true" type="INTEGER" required="true" description="Id del producto" primaryKey='true' />
    <column name="code" size="255" type="VARCHAR" description="Codigo del producto" />
    <column name="description" size="255" type="VARCHAR" required="false" description="Descripcion" />
    <column name="price" type="FLOAT" description="Precio del producto" />
  </table>
  
  <table phpName="ProductCategory" name="productCategory" description="Categorias de Productos">
    <column name="id" autoIncrement="true" type="INTEGER" required="true" description="Id de la categoria" primaryKey='true' />
    <column name="description" size="255" type="VARCHAR" required="false" description="Descripcion" />
  </table>

  </database>
